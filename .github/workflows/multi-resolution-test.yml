# ë‹¤ì¤‘ í•´ìƒë„ ìˆœì°¨ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ (ì°¸ê³ ìš©)
name: Multi-Resolution Test (Sequential)

on:
  push:
    branches: [ "feature/multi-resolution-test" ]

jobs:
  multi-resolution-test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'

    - name: Setup Gradle
      uses: gradle/actions/setup-gradle@af1da67850ed9a4cedd57bfd976089dd991e2582

    - name: Make gradlew executable
      run: chmod +x ./gradlew

    # í•´ìƒë„ë³„ ìˆœì°¨ í…ŒìŠ¤íŠ¸
    - name: Test on 1920x1080 (Full HD)
      run: |
        echo "ğŸ–¥ï¸ Testing on Full HD (1920x1080)"
        sudo apt-get update -qq
        sudo apt-get install -y xvfb
        export DISPLAY=:99
        Xvfb :99 -ac -screen 0 1920x1080x24 -nolisten tcp &
        sleep 3
        ./gradlew test --no-daemon || echo "Full HD test completed"
        pkill Xvfb || true
      env:
        JAVA_OPTS: "-Djava.awt.headless=false -Dtest.resolution=1920x1080"

    - name: Test on 1280x720 (HD)
      run: |
        echo "ğŸ–¥ï¸ Testing on HD (1280x720)"
        export DISPLAY=:98
        Xvfb :98 -ac -screen 0 1280x720x24 -nolisten tcp &
        sleep 3
        ./gradlew test --no-daemon || echo "HD test completed"
        pkill Xvfb || true
      env:
        DISPLAY: :98
        JAVA_OPTS: "-Djava.awt.headless=false -Dtest.resolution=1280x720"

    - name: Test on 1024x768 (XGA)
      run: |
        echo "ğŸ–¥ï¸ Testing on XGA (1024x768)"
        export DISPLAY=:97
        Xvfb :97 -ac -screen 0 1024x768x24 -nolisten tcp &
        sleep 3
        ./gradlew test --no-daemon || echo "XGA test completed"
        pkill Xvfb || true
      env:
        DISPLAY: :97
        JAVA_OPTS: "-Djava.awt.headless=false -Dtest.resolution=1024x768"

    - name: Test on 800x600 (SVGA)
      run: |
        echo "ğŸ–¥ï¸ Testing on SVGA (800x600)"
        export DISPLAY=:96
        Xvfb :96 -ac -screen 0 800x600x24 -nolisten tcp &
        sleep 3
        ./gradlew test --no-daemon || echo "SVGA test completed"
        pkill Xvfb || true
      env:
        DISPLAY: :96
        JAVA_OPTS: "-Djava.awt.headless=false -Dtest.resolution=800x600"